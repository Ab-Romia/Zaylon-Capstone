# Database Configuration
# For Supabase (Render deployment - use Session Mode for IPv4 compatibility):
# Format: postgresql+asyncpg://postgres.[PROJECT-REF]:[PASSWORD]@aws-0-[REGION].pooler.supabase.com:5432/postgres
#
# IMPORTANT for Render deployments:
# - Use Session Mode (port 5432) NOT Transaction Mode (port 6543)
# - Session Mode provides IPv4-compatible connections (fixes "Network is unreachable" IPv6 errors)
# - Get this from: Supabase Dashboard > Project Settings > Database > Connection String > Session Mode
#
# Driver options:
# - postgresql+asyncpg:// - asyncpg driver (recommended, used by this project)
# - postgresql+psycopg:// - psycopg3 driver (alternative, no Rust compilation needed)
#
# For local development:
DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/ecommerce_dm

# API Security
API_KEY=your-super-secret-api-key-here

# Rate Limiting
RATE_LIMIT_PER_MINUTE=100

# Cache Settings
DEFAULT_CACHE_TTL_HOURS=24

# Performance Tuning
MAX_CONVERSATION_HISTORY=50
MAX_PRODUCT_SEARCH_RESULTS=5

# Analytics
ANALYTICS_RETENTION_DAYS=90

# CORS (comma-separated origins or * for all)
ALLOWED_ORIGINS=*

# Application
APP_NAME=E-commerce DM Microservice
APP_VERSION=2.0.0
DEBUG=false

# ==============================================================================
# RAG System Configuration (NEW in v2.0)
# ==============================================================================

# Vector Database (Qdrant)
# For Docker: http://qdrant:6333
# For local Qdrant: http://localhost:6333
# For Qdrant Cloud: https://your-cluster.qdrant.tech
# For Render: Use Qdrant Cloud URL (Qdrant doesn't have a free tier on Render)
QDRANT_URL=http://localhost:6333
QDRANT_API_KEY=
QDRANT_COLLECTION_PRODUCTS=products
QDRANT_COLLECTION_KNOWLEDGE=knowledge_base

# ==============================================================================
# LLM Provider Configuration (NEW)
# ==============================================================================

# LLM Provider Selection
# Options: "openai" or "gemini"
# This controls which provider is used for both agents and embeddings
LLM_PROVIDER=openai

# OpenAI Configuration
# Get API key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_CHAT_MODEL=gpt-4o
OPENAI_CHAT_MODEL_MINI=gpt-4o-mini

# Google Gemini Configuration
# Get API key from: https://aistudio.google.com/app/apikey
GEMINI_API_KEY=your-gemini-api-key-here
GEMINI_CHAT_MODEL=gemini-2.0-flash-exp
GEMINI_CHAT_MODEL_MINI=gemini-2.0-flash-exp
GEMINI_EMBEDDING_MODEL=models/text-embedding-004

# Embeddings Configuration
# OpenAI models: text-embedding-3-small (cheapest), text-embedding-3-large (best quality)
EMBEDDING_MODEL=text-embedding-3-small

# Local embedding model (fallback or primary if USE_LOCAL_EMBEDDINGS=true)
# Good multilingual model for Arabic/English/Franco-Arabic:
LOCAL_EMBEDDING_MODEL=sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2

# Use local embeddings instead of OpenAI (true/false)
# Set to 'true' to avoid OpenAI costs (uses Sentence Transformers)
# Set to 'false' for better quality (uses OpenAI, requires OPENAI_API_KEY)
USE_LOCAL_EMBEDDINGS=false

# Embedding dimension (auto-detected, but can be overridden)
# OpenAI text-embedding-3-small: 1536
# Local paraphrase-multilingual-MiniLM-L12-v2: 384
EMBEDDING_DIMENSION=1536

# RAG Retrieval Settings
RAG_TOP_K=5                         # Number of similar items to retrieve
RAG_SIMILARITY_THRESHOLD=0.7        # Minimum similarity score (0-1)
RAG_MAX_CONTEXT_LENGTH=4000         # Maximum tokens for RAG context
RAG_CHUNK_SIZE=500                  # Document chunk size for indexing
RAG_CHUNK_OVERLAP=50                # Overlap between chunks

# RAG Features (true/false)
ENABLE_SEMANTIC_SEARCH=true         # Use vector search for products
ENABLE_KNOWLEDGE_BASE=true          # Include KB in responses
ENABLE_HYBRID_SEARCH=true           # Combine keyword + vector search

# Docker Compose Settings (used when running with docker-compose)
POSTGRES_USER=ecommerce
POSTGRES_PASSWORD=ecommerce_password
POSTGRES_DB=ecommerce_dm
